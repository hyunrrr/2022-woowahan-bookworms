# 클린 아키텍처

## 컴포넌트 결합 (116 ~ 138)

### ADP: 의존성 비순환 원칙

**탄생 배경**

- 본인이 어떤 기능을 만들었는데, 다른 사람이 특정 부분의 코드를 건드리면서 작동을 안하게 되는 현상
  즉 '숙취 증후군'을 예방하고자 만들어짐
- 이를 해결하기 위해 컴포넌트 단위로 개발팀을 만들고 릴리스 함.
  다른 컴포넌트에 의존하는 경우, 그 컴포넌트가 새로운 버전을 릴리스할 때
  점검을 하고 갈아탈 수 있음.
- 하지만 컴포넌트간에 순환 의존성이 생기면 어떤 컴포넌트부터 릴리스 해야할지 결정도 못하고,
  하나의 거대한 컴포넌트가 되어 테스트도 불가능해진다.
- 순환을 끊는 방법
  - 의존성 역전 원칙 DIP 를 이용한다.
  - 공통된 로직을 새로운 컴포넌트로 옮기고 의존하게 한다.

### SDP: 안정된 의존성 원칙

> 안정적인 방향으로 의존해라

- 반대로 되면 변경이 쉽지 않음.
  **안정적인 컴포넌트란?**
- 변경하기 어려운 컴포넌트 - 책임지는 컴포넌트가 많고, 의존하는 컴포넌트가 없음
  **안정성을 측정하는 법**
  -fan-in: 안으로 들어오는 의존성
  -fan-out: 바깥으로 나가는 의존성
- I = fan-out % (fan-in + fan-out)
  **만약 안정적인 컴포넌트가 불완전한 컴포넌트를 의존할 때**
- DIP를 이용한다.
  안정적인 컴포넌트에게 필요한 기능을
  추상 컴퍼넌트로 추출하고,
  불완전한 컴포넌트가 이를 구현하게 한다.

### SAP: 안정된 추상화 원칙

> 안정된 컴포넌트는 추상 컴포넌트이고, 불완전한 컴포넌트는 구체 컴포넌트여야 한다.
> **추상화 정도 측정하는 법**

- Nc: 컴포넌트 클래스 개수
- Na: 컴포넌트의 추상 클래스와 인터페이스 개수
- A = Na % Nc

## 안정성과 추상화

### 안정성이 0, 추상화가 1

- 최고로 안정적이며 추상화된 컴포넌트

### 안정성이 1, 추상화가 0

- 최고로 불안정하며 구체화된 컴포넌트

### 안정성이 0, 추상화가 0

- 안정적이며 구체화된 컴포넌트 (즉 뻣뻣하다)
- 안정적이라 변경도 어렵고, 구체화돼서 확장도 어렵다.
  만약 이를 변경하면 의존하는 컴포넌트들을 다 테스트해봐야한다.

### 안정성이 1, 추상화가 1

    - 불완전하며 추상화된 컴포넌트
    - 불완전하기 때문에 어떤 컴포넌트도 의존하지 않고,
      추상적이라 기능도 없기 때문에, 아주 쓸모 없다.

### 의의

- 안정성 정도와 추상화 정도를 적절하게 매치한 컴포넌트를 만들어야 한다.

### 느낀점

설계 진짜 넘나 어렵다...
